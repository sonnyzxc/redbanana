<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<link href="https://fonts.googleapis.com/css2?family=Roboto+Flex:opsz,wght@8..144,300&display=swap" rel="stylesheet">
    <style>
        #parentdiv {
            background-color: #eae4dd;
            font-family: 'Roboto Flex', sans-serif;
            margin: 0px;
            padding: 0px;
        }


        .div2 {
            position: absolute;
            width: 80px;
            height: 80px;
            background-color: #ffafcc;
            border-radius: 50%;
            display: table-cell;
            text-align: center;
            vertical-align: bottom; 
            font-family: 'Roboto Flex', sans-serif;
        }

        .div2:hover:after {
            position: absolute;
            width: 100px;
            height: 80px;
            background-color: #ffffff;
            border-radius: 10px;
            display: table-cell;
            text-align: center;
            vertical-align: middle; 
            font-family: 'Roboto Flex', sans-serif;
            content: attr(title);
            opacity: 0.4;
        }

        .circle {
            left: 50px;
            top: 50px;
            background-color: #494949;
            margin: 10%;
            border-radius: 10%;
            font-family: 'Roboto Flex', sans-serif;
            float: left;
        }

        .circle-inner {
            display: table-cell;
            text-align: center;
            vertical-align: middle; 
            border-radius: 100%;
            font-family: 'Roboto Flex', sans-serif;
            color: #101010;
            font-size: 20px;
        }


        body {
            font-family: 'Roboto Flex', sans-serif; 
            background-color: #eae4dd;
        }

        #rcorners1 {
            border-radius: 25px;
            background: #DAD0D0;
            padding: 20px; 
            width: 200px;
            font-family: 'Roboto Flex', sans-serif;
            float: left;
            margin: 2%;
        }

        #rcorners2 {
            border-radius: 25px;
            background: #DAD0D0;
            padding: 20px; 
            width: 200px;
            font-family: 'Roboto Flex', sans-serif;
            float: right;
            margin: 2%;
            text-align: center;
        }

        #name {
            font-family: 'Roboto Flex', sans-serif;
        }

        li {
            margin: 3%;
        }

        #commentName {
            text-align: right;
            font-family: 'Roboto Flex', sans-serif;
        }

        * {
            font-family: 'Roboto Flex', sans-serif;
        }

        #idChan {
            float: left;
            padding: 0%;
            color: black;
            font-weight: bold;
            width: 300;
        }
        #circlediv {
            margin: auto;
        }

        .topnav {
        background-color: #555;
        overflow: hidden;
        }

        /* Style the links inside the navigation bar */
        .topnav a {
        float: left;
        color: #f2f2f2;
        text-align: center;
        padding: 14px 30px;
        text-decoration: none;
        font-size: 17px;
        }

        /* Change the color of links on hover */
        .topnav a:hover {
        background-color: #ddd;
        color: black;
        }

        /* Add a color to the active/current link */
        .topnav a.active {
        background-color: #bca0dc;
        color: white;
        text-align: right;
        }
    </style>
    <body>
        <script>
            let minutes = 0;
            let seconds = 0;
            function incrementStopwatch() {
                seconds++;
                if (seconds >= 60) {
                minutes++;
                seconds = 0;
                }
                let formattedMinutes = String(minutes).padStart(2, "0");
                let formattedSeconds = String(seconds).padStart(2, "0");
                document.getElementById("stopwatch").innerHTML = `${formattedMinutes}:${formattedSeconds}`;
            }
            setInterval(incrementStopwatch, 1000);
        </script>
    </div>
    <div class="topnav">
        <a href="https://www.imperial.ac.uk/    ">Contact</a>
        <a href="#about">About</a>
        <a class="active" href="../">Logout</a>
      </div>
        <div id="rcorners1">
        <div id="idChan"></div>
        </div>
        <div id="circlediv"></div>
        <div id="rcorners2">
            <b id="name" style="width: fit-content;">
                <h2><b id="name" style="text-align:center;">
                    Tommy Kang
                </b></h2>
                <hr>  
                <div>   
                    <div>

                        <p>
                            Login Time&nbsp;&nbsp;&nbsp;&nbsp;--------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="stopwatch">00:00</span>
                        </p>
                        <p>
                            Code Lines&nbsp;&nbsp;&nbsp;&nbsp;--------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{cur_employee.lines}}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        </p>
                        <p>
                            Praises&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -------- &nbsp;&nbsp;&nbsp;&nbsp;{{cur_employee.praises}}
                        </p>
                    </div>
                <hr>  
                <b>
                    <h3>Today's Tasks:</h3>
                </b>
                
                <input type="text" id="new-todo" placeholder="Add a new task">
                <button id="add-todo">Add</button>
                <ul id="todo-list" style="list-style-type: none; padding: 0 0 0 0; text-align: left;"></ul>
                <hr>  
                <script>
                  const todoList = document.getElementById("todo-list");
                  const newTodo = document.getElementById("new-todo");
                  const addTodoButton = document.getElementById("add-todo");
            
                  addTodoButton.addEventListener("click", function() {
                    const todoText = newTodo.value;
                    if (!todoText) return;
                    const todoItem = document.createElement("li");
                    const todoCheckbox = document.createElement("input");
                    todoCheckbox.type = "checkbox";
                    todoItem.appendChild(todoCheckbox);
                    todoItem.appendChild(document.createTextNode(todoText));
                    todoList.appendChild(todoItem);
                    newTodo.value = "";
                  });
                </script>
            
                <b>
                    <h3>Collegue Comments:</h3>
                </b>
                <p style="margin-left: 25px; text-align: left;">
                    Fast worker!
                </p>
                <p id="commentName">
                    -&nbsp;Sonny Ku
                </p>
                <p style="margin-left: 25px; text-align: left;">
                    Please comment code!
                </p>
                <p id="commentName">
                    -&nbsp;Anonymous
                </p>
            </div>
        </div>   
    </body>

    <script   src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script>        function getRandomPastelColor() {
            let r = Math.floor(Math.random() * (256 - 128) + 128);
            let g = Math.floor(Math.random() * (256 - 128) + 128);
            let b = Math.floor(Math.random() * (256 - 128) + 128);
            return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
        }

        function getColorArray(n) {
            var c = []
            for(i = 0; i < n; i++) {
                c.push(getRandomPastelColor())
            }
            return c
        }

        const colors = getColorArray(9)
        const angle = Math.random() * Math.PI * 2

    
        function circles(n, list) {
            var div = 360 / n;
            var radius = 150;
            var parentdiv = document.getElementById("circlediv");
            var offsetToParentCenter = parseInt(parentdiv.offsetWidth / 2); //assumes parent is square
            var offsetToChildCenter = 20;
            var totalOffset = offsetToParentCenter - offsetToChildCenter;
            for (var i = 0; i < n; ++i) {
                var childdiv = document.createElement('div');
                var text = document.createElement("circle-text");
                text.textContent = list[i].employee_name;
                text.className = "circle-inner";
                //make sure text is centrered in the circle
                // text.style.position = 'absolute';
                // text.style.top = '40%';
                // childdiv.style.position = 'absolute';
                childdiv.style.whiteSpace = "pre";
                text.style.textAlign = "center";
                childdiv.title = "Time:" + list[i].online_time + "\nLines: " + list[i].lines + "\nCommits: " + list[i].commits + "\nPraises: " + list[i].praises;
                childdiv.className = "div2";
                childdiv.style.textAlign = "center";
                childdiv.appendChild(text);
            // childdiv.onmouseover();
                // childdiv.className = "div2:hover:after";
                childdiv.style.backgroundColor = colors[i];
                childdiv.style.position = 'absolute';
                var y = Math.sin((div * i) * (Math.PI / 180)) * radius;
                var x = Math.cos((div * i) * (Math.PI / 180)) * radius;
                var newx = Math.cos(angle) * x - Math.sin(angle) * y - 20
                var newy = Math.sin(angle) * x + Math.cos(angle) * y - 350
                childdiv.style.top = (newy + totalOffset).toString() + "px";
                childdiv.style.left = (newx + totalOffset).toString() + "px";
                parentdiv.appendChild(childdiv);
            }
        }    

        const sample = {
            "task1" : {
                "task1.1" : "haskell",
                "task1.2" : {
                    "task1.2.1" : "leaf"
                }
            },
            "task2" : {
                "task2.1" : "crunchy",
                "task.2.2" : "test2"
            },
            "task3" : "very simple"
        }


        function objToHtmlList(obj) {
            if (obj instanceof Object) {
                var ul = document.createElement('ul');
                for (var child in obj) {
                    var li = document.createElement('li');
                    var input = document.createElement('input');
                    input.type = "checkbox";
                    li.appendChild(document.createTextNode(child + ": "));
                    li.appendChild(objToHtmlList(obj[child]));
                    // ul.appendChild(input);
                    ul.appendChild(li);
                }
                return ul;
            }
            else {
                var li = document.createElement('ul');
                li.appendChild(document.createTextNode(obj));
                var input = document.createElement('input');
                input.type = "checkbox";
                //li.appendChild(input);
                return li;
            }
        }

        function displayTodo() {
            document.getElementById("idChan").appendChild(objToHtmlList(sample));
        }

        displayTodo()

        $(document).ready(function(){
        setInterval(function(){
            document.getElementById("circlediv").empty;
            $.ajax({
                type: 'GET',
                url : "/getStatus",
                success: function(response){
                    console.log(response.status);
                    circles(response.status.length, response.status)
    
                    // $("#user-status").empty();
                    // for (var employee in response.status)
                    // {
                    //     console.log(response.status[employee])
                    //     // var temp="<div><b>"+response.status[employee].employee_name+"</b><p>"+response.status[employee].online_time+"</p><p>"+response.status[employee].lines+"</p></div>";
                    //     // $("#user-status").append(temp);
                    // }
                },
                error: function(response){
                    // alert('An error occured')
                }
            });
        },1000);
        })


    </script>     
</html>